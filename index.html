<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Plant Dashboard | Premium Monitoring</title>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <!-- Chart.js & Plugins -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <!-- PapaParse -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <!-- html2canvas for dashboard capture -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="dashboard" id="dashboard">
        <header class="header">
            <div class="header-left">
                <h1>Power Plant Monitoring</h1>
                <p id="dateRange">Please open a CSV file to begin</p>
            </div>
            <div class="header-right">
                <label for="uploadCsv" class="btn" style="cursor: pointer;">ðŸ“‚ Open CSV</label>
                <input type="file" id="uploadCsv" accept=".csv" style="display: none;">

                <div class="date-range-group">
                    <input type="date" id="startDate" class="btn btn-sm" title="Start Date">
                    <span style="color: var(--text-secondary); font-size: 0.875rem;">to</span>
                    <input type="date" id="endDate" class="btn btn-sm" title="End Date">
                    <button id="applyDateRange" class="btn btn-sm"
                        style="background: var(--primary); color: white; border-color: var(--primary);">Go</button>
                </div>

                <div class="zoom-controls" style="display: inline-flex; gap: 8px;">
                    <button class="btn btn-sm" onclick="zoomTime(24)">1 Day</button>
                    <button class="btn btn-sm" onclick="zoomTime(24*7)">1 Week</button>
                    <button class="btn btn-sm" onclick="zoomTime(24*30)">1 Month</button>
                    <button id="resetZoomBtn" class="btn btn-sm">All</button>
                </div>

                <button class="btn btn-sm" onclick="resetApp()"
                    style="margin-left: 12px; border-color: var(--danger); color: var(--danger);"
                    title="Clear all data and reset to empty state">ðŸ”„ Reset App</button>
            </div>
        </header>

        <main class="grid-container">
            <!-- KPIs -->
            <div class="kpi-row">
                <div class="kpi-card">
                    <h3>Avg Export Power</h3>
                    <div class="value" id="kpiPower">-</div>
                    <div class="unit">MW</div>
                </div>
                <div class="kpi-card">
                    <h3>Avg Steam Flow</h3>
                    <div class="value" id="kpiSteam">-</div>
                    <div class="unit">t/h</div>
                </div>
                <div class="kpi-card">
                    <select id="kpiSelector3" class="kpi-select">
                        <option value="temp">Max Combustion Temp</option>
                        <option value="idf">Avg IDF Load</option>
                        <option value="rgf">Avg RGF Load</option>
                        <option value="paf">Avg PAF Load</option>
                    </select>
                    <div class="value" id="kpiValue3">-</div>
                    <div class="unit" id="kpiUnit3">Â°C</div>
                </div>
            </div>

            <!-- Main Chart -->
            <div class="chart-card main-chart-card">
                <div class="card-header">
                    <h2>Operation Trends</h2>
                    <div style="display: flex; gap: 12px; align-items: center;">
                        <button class="btn btn-sm" onclick="captureDashboard()" title="Capture Dashboard Screenshot">ðŸ“¸
                            Capture</button>
                        <div class="legend-toggles" id="legendToggles">
                            <!-- Checkboxes generated by JS -->
                        </div>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="mainChart"></canvas>
                </div>
            </div>
        </main>
    </div>
    <script src="data-store.js?v=3.2"></script>
    <script src="app.js"></script>
</body>

</html>